[34m[1mwandb[0m: Detected [openai] in use.
[34m[1mwandb[0m: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
[34m[1mwandb[0m: For more information, check out the docs at: https://weave-docs.wandb.ai/
  0%|                                                                                                                                                                                                                                                                                                                                               | 0/1250 [00:00<?, ?it/s]/root/miniconda3/envs/r1v/lib/python3.10/site-packages/torch/utils/checkpoint.py:86: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Invalidate trace cache @ step 0 and module 1746: cache has only 0 modules
> /root/R1-V/src/r1-v/src/open_r1/grpo.py(67)accuracy_reward()
-> reward = 0.0
['<answer>33</answer>', '<answer>40</answer>', '<answer>22</answer>', '<answer>20</answer>', '<answer>17</answer>', '<answer>30</answer>', '<answer>17</answer>', '<answer>17</answer>']
['<answer> 30 </answer>', '<answer> 30 </answer>', '<answer> 30 </answer>', '<answer> 30 </answer>', '<answer> 30 </answer>', '<answer> 30 </answer>', '<answer> 30 </answer>', '<answer> 30 </answer>']
[]
Traceback (most recent call last):
  File "/root/R1-V/src/r1-v/src/open_r1/grpo.py", line 264, in <module>
    main(script_args, training_args, model_args)
  File "/root/R1-V/src/r1-v/src/open_r1/grpo.py", line 253, in main
    trainer.train()
  File "/root/miniconda3/envs/r1v/lib/python3.10/site-packages/transformers/trainer.py", line 2241, in train
    return inner_training_loop(
  File "/root/miniconda3/envs/r1v/lib/python3.10/site-packages/transformers/trainer.py", line 2548, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/root/miniconda3/envs/r1v/lib/python3.10/site-packages/transformers/trainer.py", line 3698, in training_step
    loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
  File "/root/R1-V/src/r1-v/src/open_r1/trainer/grpo_trainer.py", line 449, in compute_loss
    output_reward_func = reward_func(prompts=prompts, completions=completions, **reward_kwargs)
  File "/root/R1-V/src/r1-v/src/open_r1/grpo.py", line 67, in accuracy_reward
    # Try symbolic verification first
  File "/root/R1-V/src/r1-v/src/open_r1/grpo.py", line 67, in accuracy_reward
    # Try symbolic verification first
  File "/root/miniconda3/envs/r1v/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/root/miniconda3/envs/r1v/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
[rank0]: Traceback (most recent call last):
[rank0]:   File "/root/R1-V/src/r1-v/src/open_r1/grpo.py", line 264, in <module>
[rank0]:     main(script_args, training_args, model_args)
[rank0]:   File "/root/R1-V/src/r1-v/src/open_r1/grpo.py", line 253, in main
[rank0]:     trainer.train()
[rank0]:   File "/root/miniconda3/envs/r1v/lib/python3.10/site-packages/transformers/trainer.py", line 2241, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/root/miniconda3/envs/r1v/lib/python3.10/site-packages/transformers/trainer.py", line 2548, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
[rank0]:   File "/root/miniconda3/envs/r1v/lib/python3.10/site-packages/transformers/trainer.py", line 3698, in training_step
[rank0]:     loss = self.compute_loss(model, inputs, num_items_in_batch=num_items_in_batch)
[rank0]:   File "/root/R1-V/src/r1-v/src/open_r1/trainer/grpo_trainer.py", line 449, in compute_loss
[rank0]:     output_reward_func = reward_func(prompts=prompts, completions=completions, **reward_kwargs)
[rank0]:   File "/root/R1-V/src/r1-v/src/open_r1/grpo.py", line 67, in accuracy_reward
[rank0]:     # Try symbolic verification first
[rank0]:   File "/root/R1-V/src/r1-v/src/open_r1/grpo.py", line 67, in accuracy_reward
[rank0]:     # Try symbolic verification first
[rank0]:   File "/root/miniconda3/envs/r1v/lib/python3.10/bdb.py", line 90, in trace_dispatch
[rank0]:     return self.dispatch_line(frame)
[rank0]:   File "/root/miniconda3/envs/r1v/lib/python3.10/bdb.py", line 115, in dispatch_line
[rank0]:     if self.quitting: raise BdbQuit
[rank0]: bdb.BdbQuit
